var image = document.querySelectorAll('img')[3];       //如果要用在greasemonkey脚本里,可以把下面的代码放在image的onload事件里          
var canvas = document.createElement('canvas');                 
var ctx = canvas.getContext("2d");                 
var numbers = [
"110000111000000100011000001111000011110000111100001111000011110000111100000110001000000111000011",
"111100111110001111000011100100111011001111110011111100111111001111110011111100111111001111110011",
"110000111000000100011100001111001111110011111001111100011110001111000111100111110000000000000000",
"110000011000000000111100111111001110000111100001111110001111110000111100000110001000000111000011",
"111110011111000111110001111000011100100111001001100110010011100100000000000000001111100111111001",
"100000011000000110011111000111110000001100000001001110001111110000111100000110001000000111000011",
"110000011000000010011100001111110010001100000001000110000011110000111100100111001000000111000011",
"000000000000000011111001111100111111001111100111111001111110011111000111110011111100111111001111",
"110000111000000100111100001111000011110010000001100000010011110000111100001111001000000111000011",
"110000111000000100111001001111000011110000011000100000001100010011111100001110010000000110000011"
];
var captcha = "";                         //存放识别后的验证码
canvas.width = image.width;
canvas.height = image.height;
document.body.appendChild(canvas);
ctx.drawImage(image, 0, 0);
for (var i = 0; i < 5; i++) {
    var pixels = ctx.getImageData(9 * i + 5, 5, 8, 12).data;
    var ldString = "";
    for (var j = 0,length = pixels.length; j < length; j += 4) {
        ldString = ldString + (+(pixels[j] * 0.3 + pixels[j + 1] * 0.59 + pixels[j + 2] * 0.11 >= 140));
    }
    var comms = numbers.map(function (value) {                      //为了100%识别率,这里不能直接判断是否和模板字符串相等,因为可能有个别0被计算成1,或者相反
        return ldString.split("").filter(function (v, index) {
            return value[index] === v
        }).length
    });
    captcha += comms.indexOf(Math.max.apply(null, comms));          //添加到识别好的验证码中
}
document.querySelector("input[name=TextBox3]").value = captcha; //写入目标文本框
//reference from http://www.cnblogs.com/ziyunfei/archive/2012/10/05/2710349.html
